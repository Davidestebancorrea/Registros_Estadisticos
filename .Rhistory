openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
fecha_mes <- "2021-12-01"
censoHM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo-hrrio 2021.xlsx",
col_names = FALSE, range = "DIC!B7:P21") # Ojo que no todos los meses tiene el mismo rango
censoFM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo ssmn 2021.xlsx",
col_names = FALSE, range = "DIC-UF!B7:I20")
# CENSO HRRIO -------------------------------------------------------------------
colnames(censoHM)[1] <- "Información estadistica"
colnames(censoHM)[2] <- "UNIDAD PEDIATRICA UPGA Y UPGB"
colnames(censoHM)[3] <- "UNIDAD PEDIATRICA UPGC"
colnames(censoHM)[4] <- "UNIDAD PEDIATRICA UPGD"
colnames(censoHM)[5] <- "UNIDAD DE ONCOLOGÍA"
colnames(censoHM)[6] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS BASICOS"
colnames(censoHM)[7] <- "UNIDAD DE CIRUGIA GENERAL"
colnames(censoHM)[8] <- "UNIDAD DE PLASTICA Y QUEMADO"
colnames(censoHM)[9] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS MEDIOS"
colnames(censoHM)[10] <- "UNIDAD DE CUIDADO INTENSIVO PEDIATRICO"
colnames(censoHM)[11] <- "UNIDAD DE CUIDADO INTERMEDIO PEDIATRICO"
colnames(censoHM)[12] <- "UNIDAD DE CUIDADO INTENSIVO CARDIOVASCULAR"
colnames(censoHM)[13] <- "UNIDAD DE CUIDADO INTERMEDIO CARDIOVASCULAR"
colnames(censoHM)[14] <- "SALUD MENTAL CORTA ESTADÍA"
colnames(censoHM)[15] <- "SALUD MENTAL MEDIANA ESTADÍA"
censoHM$`SALUD MENTAL MEDIANA ESTADÍA` <- as.double(censoHM$`SALUD MENTAL MEDIANA ESTADÍA`)
censoHM$`UNIDAD PEDIATRICA UPGD` <- as.double(censoHM$`UNIDAD PEDIATRICA UPGD`)
censoHM <- censoHM %>% pivot_longer(- `Información estadistica`,
names_to = "Unidad",
values_to = "Total")
censoHM$Fecha <- fecha_mes
censoHM <- censoHM %>% select(Fecha, Unidad,`Información estadistica`, Total)
censoHM$Fecha=as.Date(censoHM$Fecha)
Censo_hrrio_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx")
Censo_hrrio_BBDD <- rbind(censoHM, Censo_hrrio_BBDD)
openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
library(readxl)
library(tidyverse)
library(dplyr)
fecha_mes <- "2021-12-01"
censoHM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo-hrrio 2021.xlsx",
col_names = FALSE, range = "DIC!B7:P21") # Ojo que no todos los meses tiene el mismo rango
censoFM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo ssmn 2021.xlsx",
col_names = FALSE, range = "DIC-UF!B7:I20")
# CENSO HRRIO -------------------------------------------------------------------
colnames(censoHM)[1] <- "Información estadistica"
colnames(censoHM)[2] <- "UNIDAD PEDIATRICA UPGA Y UPGB"
colnames(censoHM)[3] <- "UNIDAD PEDIATRICA UPGC"
colnames(censoHM)[4] <- "UNIDAD PEDIATRICA UPGD"
colnames(censoHM)[5] <- "UNIDAD DE ONCOLOGÍA"
colnames(censoHM)[6] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS BASICOS"
colnames(censoHM)[7] <- "UNIDAD DE CIRUGIA GENERAL"
colnames(censoHM)[8] <- "UNIDAD DE PLASTICA Y QUEMADO"
colnames(censoHM)[9] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS MEDIOS"
colnames(censoHM)[10] <- "UNIDAD DE CUIDADO INTENSIVO PEDIATRICO"
colnames(censoHM)[11] <- "UNIDAD DE CUIDADO INTERMEDIO PEDIATRICO"
colnames(censoHM)[12] <- "UNIDAD DE CUIDADO INTENSIVO CARDIOVASCULAR"
colnames(censoHM)[13] <- "UNIDAD DE CUIDADO INTERMEDIO CARDIOVASCULAR"
colnames(censoHM)[14] <- "SALUD MENTAL CORTA ESTADÍA"
colnames(censoHM)[15] <- "SALUD MENTAL MEDIANA ESTADÍA"
censoHM$`SALUD MENTAL MEDIANA ESTADÍA` <- as.double(censoHM$`SALUD MENTAL MEDIANA ESTADÍA`)
censoHM$`UNIDAD PEDIATRICA UPGD` <- as.double(censoHM$`UNIDAD PEDIATRICA UPGD`)
censoHM <- censoHM %>% pivot_longer(- `Información estadistica`,
names_to = "Unidad",
values_to = "Total")
censoHM$Fecha <- fecha_mes
censoHM <- censoHM %>% select(Fecha, Unidad,`Información estadistica`, Total)
censoHM$Fecha=as.Date(censoHM$Fecha)
Censo_hrrio_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx")
Censo_hrrio_BBDD <- rbind(censoHM, Censo_hrrio_BBDD)
openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
library(readxl)
library(tidyverse)
library(dplyr)
fecha_mes <- "2021-11-01"
censoHM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo-hrrio 2021.xlsx",
col_names = FALSE, range = "DIC!B7:P21") # Ojo que no todos los meses tiene el mismo rango
censoFM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo ssmn 2021.xlsx",
col_names = FALSE, range = "DIC-UF!B7:I20")
# CENSO HRRIO -------------------------------------------------------------------
colnames(censoHM)[1] <- "Información estadistica"
colnames(censoHM)[2] <- "UNIDAD PEDIATRICA UPGA Y UPGB"
colnames(censoHM)[3] <- "UNIDAD PEDIATRICA UPGC"
colnames(censoHM)[4] <- "UNIDAD PEDIATRICA UPGD"
colnames(censoHM)[5] <- "UNIDAD DE ONCOLOGÍA"
colnames(censoHM)[6] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS BASICOS"
colnames(censoHM)[7] <- "UNIDAD DE CIRUGIA GENERAL"
colnames(censoHM)[8] <- "UNIDAD DE PLASTICA Y QUEMADO"
colnames(censoHM)[9] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS MEDIOS"
colnames(censoHM)[10] <- "UNIDAD DE CUIDADO INTENSIVO PEDIATRICO"
colnames(censoHM)[11] <- "UNIDAD DE CUIDADO INTERMEDIO PEDIATRICO"
colnames(censoHM)[12] <- "UNIDAD DE CUIDADO INTENSIVO CARDIOVASCULAR"
colnames(censoHM)[13] <- "UNIDAD DE CUIDADO INTERMEDIO CARDIOVASCULAR"
colnames(censoHM)[14] <- "SALUD MENTAL CORTA ESTADÍA"
colnames(censoHM)[15] <- "SALUD MENTAL MEDIANA ESTADÍA"
censoHM$`SALUD MENTAL MEDIANA ESTADÍA` <- as.double(censoHM$`SALUD MENTAL MEDIANA ESTADÍA`)
censoHM$`UNIDAD PEDIATRICA UPGD` <- as.double(censoHM$`UNIDAD PEDIATRICA UPGD`)
censoHM <- censoHM %>% pivot_longer(- `Información estadistica`,
names_to = "Unidad",
values_to = "Total")
censoHM$Fecha <- fecha_mes
censoHM <- censoHM %>% select(Fecha, Unidad,`Información estadistica`, Total)
censoHM$Fecha=as.Date(censoHM$Fecha)
Censo_hrrio_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx")
Censo_hrrio_BBDD <- rbind(censoHM, Censo_hrrio_BBDD)
openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
library(readxl)
library(tidyverse)
library(dplyr)
fecha_mes <- "2021-10-01"
censoHM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo-hrrio 2021.xlsx",
col_names = FALSE, range = "DIC!B7:P21") # Ojo que no todos los meses tiene el mismo rango
censoFM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo ssmn 2021.xlsx",
col_names = FALSE, range = "DIC-UF!B7:I20")
# CENSO HRRIO -------------------------------------------------------------------
colnames(censoHM)[1] <- "Información estadistica"
colnames(censoHM)[2] <- "UNIDAD PEDIATRICA UPGA Y UPGB"
colnames(censoHM)[3] <- "UNIDAD PEDIATRICA UPGC"
colnames(censoHM)[4] <- "UNIDAD PEDIATRICA UPGD"
colnames(censoHM)[5] <- "UNIDAD DE ONCOLOGÍA"
colnames(censoHM)[6] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS BASICOS"
colnames(censoHM)[7] <- "UNIDAD DE CIRUGIA GENERAL"
colnames(censoHM)[8] <- "UNIDAD DE PLASTICA Y QUEMADO"
colnames(censoHM)[9] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS MEDIOS"
colnames(censoHM)[10] <- "UNIDAD DE CUIDADO INTENSIVO PEDIATRICO"
colnames(censoHM)[11] <- "UNIDAD DE CUIDADO INTERMEDIO PEDIATRICO"
colnames(censoHM)[12] <- "UNIDAD DE CUIDADO INTENSIVO CARDIOVASCULAR"
colnames(censoHM)[13] <- "UNIDAD DE CUIDADO INTERMEDIO CARDIOVASCULAR"
colnames(censoHM)[14] <- "SALUD MENTAL CORTA ESTADÍA"
colnames(censoHM)[15] <- "SALUD MENTAL MEDIANA ESTADÍA"
censoHM$`SALUD MENTAL MEDIANA ESTADÍA` <- as.double(censoHM$`SALUD MENTAL MEDIANA ESTADÍA`)
censoHM$`UNIDAD PEDIATRICA UPGD` <- as.double(censoHM$`UNIDAD PEDIATRICA UPGD`)
censoHM <- censoHM %>% pivot_longer(- `Información estadistica`,
names_to = "Unidad",
values_to = "Total")
censoHM$Fecha <- fecha_mes
censoHM <- censoHM %>% select(Fecha, Unidad,`Información estadistica`, Total)
censoHM$Fecha=as.Date(censoHM$Fecha)
Censo_hrrio_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx")
Censo_hrrio_BBDD <- rbind(censoHM, Censo_hrrio_BBDD)
openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
fecha_mes <- "2021-12-01"
censoHM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo-hrrio 2021.xlsx",
col_names = FALSE, range = "DIC!B7:P21") # Ojo que no todos los meses tiene el mismo rango
censoFM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo ssmn 2021.xlsx",
col_names = FALSE, range = "DIC-UF!B7:I20")
# CENSO HRRIO -------------------------------------------------------------------
colnames(censoHM)[1] <- "Información estadistica"
colnames(censoHM)[2] <- "UNIDAD PEDIATRICA UPGA Y UPGB"
colnames(censoHM)[3] <- "UNIDAD PEDIATRICA UPGC"
colnames(censoHM)[4] <- "UNIDAD PEDIATRICA UPGD"
colnames(censoHM)[5] <- "UNIDAD DE ONCOLOGÍA"
colnames(censoHM)[6] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS BASICOS"
colnames(censoHM)[7] <- "UNIDAD DE CIRUGIA GENERAL"
colnames(censoHM)[8] <- "UNIDAD DE PLASTICA Y QUEMADO"
colnames(censoHM)[9] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS MEDIOS"
colnames(censoHM)[10] <- "UNIDAD DE CUIDADO INTENSIVO PEDIATRICO"
colnames(censoHM)[11] <- "UNIDAD DE CUIDADO INTERMEDIO PEDIATRICO"
colnames(censoHM)[12] <- "UNIDAD DE CUIDADO INTENSIVO CARDIOVASCULAR"
colnames(censoHM)[13] <- "UNIDAD DE CUIDADO INTERMEDIO CARDIOVASCULAR"
colnames(censoHM)[14] <- "SALUD MENTAL CORTA ESTADÍA"
colnames(censoHM)[15] <- "SALUD MENTAL MEDIANA ESTADÍA"
censoHM$`SALUD MENTAL MEDIANA ESTADÍA` <- as.double(censoHM$`SALUD MENTAL MEDIANA ESTADÍA`)
censoHM$`UNIDAD PEDIATRICA UPGD` <- as.double(censoHM$`UNIDAD PEDIATRICA UPGD`)
censoHM <- censoHM %>% pivot_longer(- `Información estadistica`,
names_to = "Unidad",
values_to = "Total")
censoHM$Fecha <- fecha_mes
censoHM <- censoHM %>% select(Fecha, Unidad,`Información estadistica`, Total)
censoHM$Fecha=as.Date(censoHM$Fecha)
Censo_hrrio_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx")
Censo_hrrio_BBDD <- rbind(censoHM, Censo_hrrio_BBDD)
openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
library(readxl)
library(tidyverse)
library(dplyr)
fecha_mes <- "2021-12-01"
censoHM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo-hrrio 2021.xlsx",
col_names = FALSE, range = "DIC!B7:P21") # Ojo que no todos los meses tiene el mismo rango
censoFM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo ssmn 2021.xlsx",
col_names = FALSE, range = "DIC-UF!B7:I20")
# CENSO HRRIO -------------------------------------------------------------------
colnames(censoHM)[1] <- "Información estadistica"
colnames(censoHM)[2] <- "UNIDAD PEDIATRICA UPGA Y UPGB"
colnames(censoHM)[3] <- "UNIDAD PEDIATRICA UPGC"
colnames(censoHM)[4] <- "UNIDAD PEDIATRICA UPGD"
colnames(censoHM)[5] <- "UNIDAD DE ONCOLOGÍA"
colnames(censoHM)[6] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS BASICOS"
colnames(censoHM)[7] <- "UNIDAD DE CIRUGIA GENERAL"
colnames(censoHM)[8] <- "UNIDAD DE PLASTICA Y QUEMADO"
colnames(censoHM)[9] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS MEDIOS"
colnames(censoHM)[10] <- "UNIDAD DE CUIDADO INTENSIVO PEDIATRICO"
colnames(censoHM)[11] <- "UNIDAD DE CUIDADO INTERMEDIO PEDIATRICO"
colnames(censoHM)[12] <- "UNIDAD DE CUIDADO INTENSIVO CARDIOVASCULAR"
colnames(censoHM)[13] <- "UNIDAD DE CUIDADO INTERMEDIO CARDIOVASCULAR"
colnames(censoHM)[14] <- "SALUD MENTAL CORTA ESTADÍA"
colnames(censoHM)[15] <- "SALUD MENTAL MEDIANA ESTADÍA"
censoHM$`SALUD MENTAL MEDIANA ESTADÍA` <- as.double(censoHM$`SALUD MENTAL MEDIANA ESTADÍA`)
censoHM$`UNIDAD PEDIATRICA UPGD` <- as.double(censoHM$`UNIDAD PEDIATRICA UPGD`)
censoHM <- censoHM %>% pivot_longer(- `Información estadistica`,
names_to = "Unidad",
values_to = "Total")
censoHM$Fecha <- fecha_mes
censoHM <- censoHM %>% select(Fecha, Unidad,`Información estadistica`, Total)
censoHM$Fecha=as.Date(censoHM$Fecha)
Censo_hrrio_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx")
Censo_hrrio_BBDD <- rbind(censoHM, Censo_hrrio_BBDD)
openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
fecha_mes <- "2021-11-01"
censoHM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo-hrrio 2021.xlsx",
col_names = FALSE, range = "NOV!B7:P21") # Ojo que no todos los meses tiene el mismo rango
censoFM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo ssmn 2021.xlsx",
col_names = FALSE, range = "NOV-UF!B7:I20")
# CENSO HRRIO -------------------------------------------------------------------
colnames(censoHM)[1] <- "Información estadistica"
colnames(censoHM)[2] <- "UNIDAD PEDIATRICA UPGA Y UPGB"
colnames(censoHM)[3] <- "UNIDAD PEDIATRICA UPGC"
colnames(censoHM)[4] <- "UNIDAD PEDIATRICA UPGD"
colnames(censoHM)[5] <- "UNIDAD DE ONCOLOGÍA"
colnames(censoHM)[6] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS BASICOS"
colnames(censoHM)[7] <- "UNIDAD DE CIRUGIA GENERAL"
colnames(censoHM)[8] <- "UNIDAD DE PLASTICA Y QUEMADO"
colnames(censoHM)[9] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS MEDIOS"
colnames(censoHM)[10] <- "UNIDAD DE CUIDADO INTENSIVO PEDIATRICO"
colnames(censoHM)[11] <- "UNIDAD DE CUIDADO INTERMEDIO PEDIATRICO"
colnames(censoHM)[12] <- "UNIDAD DE CUIDADO INTENSIVO CARDIOVASCULAR"
colnames(censoHM)[13] <- "UNIDAD DE CUIDADO INTERMEDIO CARDIOVASCULAR"
colnames(censoHM)[14] <- "SALUD MENTAL CORTA ESTADÍA"
colnames(censoHM)[15] <- "SALUD MENTAL MEDIANA ESTADÍA"
censoHM$`SALUD MENTAL MEDIANA ESTADÍA` <- as.double(censoHM$`SALUD MENTAL MEDIANA ESTADÍA`)
censoHM$`UNIDAD PEDIATRICA UPGD` <- as.double(censoHM$`UNIDAD PEDIATRICA UPGD`)
censoHM <- censoHM %>% pivot_longer(- `Información estadistica`,
names_to = "Unidad",
values_to = "Total")
censoHM$Fecha <- fecha_mes
censoHM <- censoHM %>% select(Fecha, Unidad,`Información estadistica`, Total)
censoHM$Fecha=as.Date(censoHM$Fecha)
Censo_hrrio_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx")
Censo_hrrio_BBDD <- rbind(censoHM, Censo_hrrio_BBDD)
openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
fecha_mes <- "2021-10-01"
censoHM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo-hrrio 2021.xlsx",
col_names = FALSE, range = "OCT!B7:P21") # Ojo que no todos los meses tiene el mismo rango
censoFM <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/2021/Censo ssmn 2021.xlsx",
col_names = FALSE, range = "OCT-UF!B7:I20")
# CENSO HRRIO -------------------------------------------------------------------
colnames(censoHM)[1] <- "Información estadistica"
colnames(censoHM)[2] <- "UNIDAD PEDIATRICA UPGA Y UPGB"
colnames(censoHM)[3] <- "UNIDAD PEDIATRICA UPGC"
colnames(censoHM)[4] <- "UNIDAD PEDIATRICA UPGD"
colnames(censoHM)[5] <- "UNIDAD DE ONCOLOGÍA"
colnames(censoHM)[6] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS BASICOS"
colnames(censoHM)[7] <- "UNIDAD DE CIRUGIA GENERAL"
colnames(censoHM)[8] <- "UNIDAD DE PLASTICA Y QUEMADO"
colnames(censoHM)[9] <- "UNIDAD DE TRAUMATOLOGIA CUIDADOS MEDIOS"
colnames(censoHM)[10] <- "UNIDAD DE CUIDADO INTENSIVO PEDIATRICO"
colnames(censoHM)[11] <- "UNIDAD DE CUIDADO INTERMEDIO PEDIATRICO"
colnames(censoHM)[12] <- "UNIDAD DE CUIDADO INTENSIVO CARDIOVASCULAR"
colnames(censoHM)[13] <- "UNIDAD DE CUIDADO INTERMEDIO CARDIOVASCULAR"
colnames(censoHM)[14] <- "SALUD MENTAL CORTA ESTADÍA"
colnames(censoHM)[15] <- "SALUD MENTAL MEDIANA ESTADÍA"
censoHM$`SALUD MENTAL MEDIANA ESTADÍA` <- as.double(censoHM$`SALUD MENTAL MEDIANA ESTADÍA`)
censoHM$`UNIDAD PEDIATRICA UPGD` <- as.double(censoHM$`UNIDAD PEDIATRICA UPGD`)
censoHM <- censoHM %>% pivot_longer(- `Información estadistica`,
names_to = "Unidad",
values_to = "Total")
censoHM$Fecha <- fecha_mes
censoHM <- censoHM %>% select(Fecha, Unidad,`Información estadistica`, Total)
censoHM$Fecha=as.Date(censoHM$Fecha)
Censo_hrrio_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx")
Censo_hrrio_BBDD <- rbind(censoHM, Censo_hrrio_BBDD)
openxlsx::write.xlsx(Censo_hrrio_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-hrrio_BBDD.xlsx", colNames = TRUE, sheetName = "Censo", overwrite = T)
# CENSO UNIDADES FUNCIONALES ----------------------------------------------
colnames(censoFM)[1] <- "Información estadistica"
colnames(censoFM)[2] <- "AREA MEDICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[3] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS BASICOS"
colnames(censoFM)[4] <- "AREA MEDICA QUIRURGICA PEDIATRICA CUIDADOS MEDIOS"
colnames(censoFM)[5] <- "AREA MEDICA CUIDADOS INTENSIVOS PEDIATRICOS"
colnames(censoFM)[6] <- "AREA MEDICA CUIDADOS INTERMEDIOS PEDIATRICOS"
colnames(censoFM)[7] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE CORTA ESTADIA"
colnames(censoFM)[8] <- "AREA PSIQUIATRIA INFANTO ADOLESCENTE MEDIANA ESTADIA"
censoFM <- censoFM %>% pivot_longer(- `Información estadistica`,
names_to = "UNIDAD FUNCIONAL",
values_to = "Total")
censoFM$Fecha <- fecha_mes
censoFM <- censoFM %>% select(Fecha, `UNIDAD FUNCIONAL`,`Información estadistica`, Total)
censoFM$Fecha=as.Date(censoFM$Fecha)
Censo_FUNCIONAL_BBDD <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx")
Censo_FUNCIONAL_BBDD <- rbind(censoFM, Censo_FUNCIONAL_BBDD)
openxlsx::write.xlsx(Censo_FUNCIONAL_BBDD, "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/CENSO/Censo-FUNCIONAL_BBDD.xlsx",
colNames = TRUE, sheetName = "Censo", overwrite = T)
rm(censoFM, censoHM, fecha_mes, Censo_FUNCIONAL_BBDD, Censo_hrrio_BBDD)
# Librerias ---------------------------------------------------------------
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(dplyr)
library(openxlsx)
library(xlsx)
#Puedo crear un proyecto en la carpeta MEGA para incluir todo lo de adentro
# Archivos mensuales ------------------------------------------------------
#___________________Cada mes debo cambiar las variables #fecha_mes y archivo
#___________________Estas variables sirven a todas las BBDD del Script
fecha_mes <- "2021-12-01"
archivoBS <- "C:/Users/control.gestion3/OneDrive/BBDD Produccion/REM/Serie BS/2021/2021-12 REM serie BS.xlsx"
# Representan las BBDD donde esta guardada la información -----------------
B_IMGBBDD <- "C:/Users/control.gestion3/OneDrive/BBDD Produccion/ADyT/B_IMG BBDD.xlsx"
B_LABBBDD <- "C:/Users/control.gestion3/OneDrive/BBDD Produccion/ADyT/B_LAB BBDD.xlsx"
B_APBBDD <- "C:/Users/control.gestion3/OneDrive/BBDD Produccion/ADyT/B_AP BBDD.xlsx"
B_UMTBBDD <- "C:/Users/control.gestion3/OneDrive/BBDD Produccion/ADyT/B_UMT BBDD.xlsx"
B_QfBBDD <- "C:/Users/control.gestion3/OneDrive/BBDD Produccion/Quirurgico/B_Qf BBDD.xlsx"
B171_QfBBDD <- "C:/Users/control.gestion3/OneDrive/BBDD Produccion/Quirurgico/B171_Qf BBDD.xlsx"
B172_QfBBDD <- "C:/Users/control.gestion3/OneDrive/BBDD Produccion/Quirurgico/B172_Qf BBDD.xlsx"
B_Img01 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!A610:AL667")
B_Img01$'Clasificación' <- "Ex Radiologicos Simples"
B_Img02 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!A671:AL691")
B_Img02$'Clasificación' <- "Ex Radiologicos Complejos"
B_Img03 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!A694:AL721")
B_Img03$'Clasificación' <- "Tomografia Axial Comp"
B_Img04 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!A724:AL745")
B_Img04$'Clasificación' <- "Ultrasonografia"
B_Img05 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!A748:AL778")
B_Img05$'Clasificación' <- "Resonancia Magnética"
B_ImgM <- rbind(B_Img01, B_Img02, B_Img03, B_Img04, B_Img05)
B_ImgM <- mutate_all(B_ImgM, ~replace(., is.na(.), 0))
B_ImgM$Fecha <- fecha_mes
B_ImgM$"Centros de Costos" <-'542-IMAGENOLOGÍA'
View(B_Img01)
View(B_Img02)
View(B_Img03)
View(B_Img04)
View(B_Img05)
View(B_ImgM)
colnames(B_ImgM)[1] <- "Codigo"
colnames(B_ImgM)[2] <- "Glosa"
colnames(B_ImgM)[3] <- "Total"
colnames(B_ImgM)[27] <- "Procedencia Atención Cerrada"
colnames(B_ImgM)[28] <- "Procedencia Atención Abierta"
colnames(B_ImgM)[29] <- "Procedencia Emergencia"
colnames(B_ImgM)[38] <- "Total Facturado"
View(B_ImgM)
colnames(B_ImgM)[1] <- "Codigo"
colnames(B_ImgM)[2] <- "Glosa"
colnames(B_ImgM)[3] <- "Total"
colnames(B_ImgM)[27] <- "Procedencia Atención Cerrada"
colnames(B_ImgM)[28] <- "Procedencia Atención Abierta"
colnames(B_ImgM)[29] <- "Procedencia Emergencia"
colnames(B_ImgM)[38] <- "Total Facturado"
View(B_ImgM)
